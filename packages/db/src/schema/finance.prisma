model Wallet {
    id              String               @id @default(uuid())
    name            String
    schoolProfile   SchoolProfile?       @relation(fields: [schoolProfileId], references: [id])
    schoolProfileId String?
    sessionTerm     SessionTerm?         @relation(fields: [sessionTermId], references: [id])
    sessionTermId   String?
    transactions    WalletTransactions[]
    bills           Bills[]

    createdAt DateTime? @default(now()) @db.Timestamp(0)
    updatedAt DateTime? @updatedAt
    deletedAt DateTime? @db.Timestamp(0)

    @@unique([name, schoolProfileId, sessionTermId])
}

model WalletTransactions {
    id       String  @id @default(uuid())
    wallet   Wallet? @relation(fields: [walletId], references: [id])
    type     String
    summary  String?
    amount   Float
    walletId String?

    studentPayment StudentPayment?
    billPayment    BillPayment?

    createdAt DateTime? @default(now()) @db.Timestamp(0)
    updatedAt DateTime? @updatedAt
    deletedAt DateTime? @db.Timestamp(0)
}

model Bills {
    id          String   @id @default(uuid())
    description String
    type        BillType
    amount      Float?

    createdAt DateTime?    @default(now()) @db.Timestamp(0)
    updatedAt DateTime?    @updatedAt
    deletedAt DateTime?    @db.Timestamp(0)
    invoice   BillInvoice? @relation(fields: [invoiceId], references: [id])
    invoiceId String?

    staffSessionProfile   StaffSessionProfile? @relation(fields: [staffSessionProfileId], references: [id])
    staffSessionProfileId String?
    Wallet                Wallet?              @relation(fields: [walletId], references: [id])
    walletId              String?
}

enum BillType {
    SALARY
    MISC
}

model BillInvoice {
    id     String  @id @default(uuid())
    amount Float?
    bills  Bills[]

    payment BillPayment?

    createdAt DateTime? @default(now()) @db.Timestamp(0)
    updatedAt DateTime? @updatedAt
    deletedAt DateTime? @db.Timestamp(0)
}

model BillPayment {
    id        String    @id @default(uuid())
    amount    Float
    createdAt DateTime? @default(now()) @db.Timestamp(0)
    updatedAt DateTime? @updatedAt
    deletedAt DateTime? @db.Timestamp(0)

    transactionId String             @unique
    transaction   WalletTransactions @relation(fields: [transactionId], references: [id])
    invoiceId     String             @unique
    invoice       BillInvoice        @relation(fields: [invoiceId], references: [id])
}
